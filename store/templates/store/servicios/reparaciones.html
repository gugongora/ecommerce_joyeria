{% extends 'base.html' %}
{% load static %}

{% block content %}
<section class="bg-white py-20 px-4">
  <div class="max-w-7xl mx-auto space-y-20">

    <!-- Sección descriptiva -->
    <div class="grid md:grid-cols-2 gap-12">
      <div class="flex flex-col justify-center">
        <h2 class="text-4xl font-bold text-[#5e0013] mb-4">Reparaciones de Joyas</h2>
        <p class="text-gray-700 mb-4">
          En <strong>Góngora Joyería</strong> restauramos el valor sentimental y estético de tus piezas. Desde ajustes simples hasta reconstrucciones complejas, nuestro maestro orfebre trabaja con precisión para devolverle vida a tus joyas.
        </p>
        <p class="text-gray-700 mb-4">
          Reparamos joyas de oro, plata y otros metales, incluyendo:
        </p>
        <ul class="list-disc list-inside text-gray-700 mb-4 space-y-1">
          <li>Soldaduras de anillos, cadenas o aros</li>
          <li>Reemplazo de piedras perdidas</li>
          <li>Enderezado de piezas deformadas</li>
          <li>Ajuste de tallas de anillos</li>
          <li>Grabados nuevos o restaurados</li>
          <li>Limpeza profunda y pulido</li>
        </ul>

        <a href="{% url 'store:contacto' %}?mensaje=Hola, necesito una reparación de joya y me gustaría saber si pueden ayudarme."
           class="mt-6 bg-[#5e0013] text-white px-6 py-3 rounded hover:bg-[#83041e] transition w-max">
          Solicitar reparación
        </a>
      </div>

      <!-- Imagen principal -->
      <div>
        <img src="{% static 'images/reparaciones-principal.jpg' %}" alt="Reparación de joyas"
             class="rounded-lg shadow-lg w-full object-cover">
      </div>
    </div>

    <!-- Galería de ejemplos -->
    <div>
      <h3 class="text-2xl font-semibold text-[#5e0013] text-center mb-8">Antes y Después</h3>
      <div class="grid sm:grid-cols-2 md:grid-cols-3 gap-6">
        <img src="{% static 'images/rep1.jpg' %}" alt="Ejemplo reparación 1" class="rounded-lg shadow">
        <img src="{% static 'images/rep2.jpg' %}" alt="Ejemplo reparación 2" class="rounded-lg shadow">
        <img src="{% static 'images/rep3.jpg' %}" alt="Ejemplo reparación 3" class="rounded-lg shadow">
      </div>
    </div>

    <!-- Formulario WhatsApp -->
    <div class="bg-gray-100 p-8 rounded-lg shadow-md max-w-2xl mx-auto">
      <h3 class="text-xl font-bold text-center text-[#5e0013] mb-6">Consulta tu reparación</h3>
      <form id="whatsappForm" novalidate>
        <div class="mb-4">
          <label for="nombre" class="block text-gray-700 font-semibold mb-1">Nombre</label>
          <input type="text" id="nombre" required class="w-full px-4 py-2 border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-[#5e0013]" placeholder="Ej: Ana Gómez">
        </div>
        <div class="mb-4">
          <label for="email" class="block text-gray-700 font-semibold mb-1">Correo electrónico</label>
          <input type="email" id="email" required class="w-full px-4 py-2 border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-[#5e0013]" placeholder="Ej: ana@email.com">
        </div>
        <div class="mb-4">
          <label for="mensaje" class="block text-gray-700 font-semibold mb-1">Mensaje</label>
          <textarea id="mensaje" rows="5" required class="w-full px-4 py-2 border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-[#5e0013]" placeholder="Hola, tengo una joya dañada que me gustaría reparar..."></textarea>
        </div>
        <p class="text-sm text-gray-600 mb-4">
          Al enviar, se abrirá WhatsApp con tu mensaje listo para enviar.
        </p>
        <button type="submit" class="bg-[#5e0013] text-white px-6 py-2 rounded hover:bg-[#83041e] transition font-semibold w-full">
          Enviar por WhatsApp
        </button>
      </form>

      <!-- Mensaje de éxito -->
      <div id="successMessage" class="hidden mt-4 flex items-start justify-between text-sm text-green-800 bg-green-100 border border-green-300 px-4 py-3 rounded" role="alert">
        <span>¡Mensaje preparado con éxito! Se abrirá WhatsApp en otra pestaña.</span>
        <button onclick="document.getElementById('successMessage').classList.add('hidden')" class="ml-4 text-green-700 hover:text-green-900 font-bold">
          ✕
        </button>
      </div>
    </div>
  </div>
</section>

<!-- Script de redirección -->
<script>
  document.getElementById('whatsappForm').addEventListener('submit', function (e) {
    e.preventDefault();

    const nombre = document.getElementById('nombre').value.trim();
    const email = document.getElementById('email').value.trim();
    const mensaje = document.getElementById('mensaje').value.trim();
    const successMessage = document.getElementById('successMessage');

    if (!nombre || !email || !mensaje) {
      alert('Por favor, completa todos los campos.');
      return;
    }

    const texto = `Hola, soy ${nombre} (${email}). Me gustaría consultar por una reparación:\n\n${mensaje}`;
    const url = `https://wa.me/56986529903?text=${encodeURIComponent(texto)}`;

    window.open(url, '_blank');
    document.getElementById('whatsappForm').reset();
    successMessage.classList.remove('hidden');
  });
</script>

{% endblock %}
